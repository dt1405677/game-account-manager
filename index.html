<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Account Manager</title>
    <link rel="stylesheet" href="style.css?v=1.3">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js'></script>
</head>

<body>
    <div class="app-layout">
        <!-- SIDEBAR -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>‚öîÔ∏è GAM</h1>
                <div class="sidebar-stats">
                    <span class="stat-chip">üí∞ <span id="totalSilver">0</span> v·∫°n</span>
                    <span class="stat-chip">üë§ <span id="totalAccounts">0</span></span>
                    <button class="stat-chip search-toggle" onclick="toggleSearch()" title="T√¨m v·∫≠t ph·∫©m">üîç
                        T√¨m</button>
                    <button id="loginBtn" class="stat-chip login-btn" onclick="toggleLogin()" title="ƒêƒÉng nh·∫≠p Google">
                        ‚òÅÔ∏è Login
                    </button>
                </div>
            </div>
            <div class="sidebar-actions">
                <input type="text" id="sidebarSearch" class="sidebar-search" placeholder="üîç T√¨m t√†i kho·∫£n..."
                    oninput="filterSidebar()">
                <button id="addAccountBtn" class="btn primary-btn sidebar-add-btn">+ Th√™m</button>
            </div>
            <div class="sidebar-data-actions">
                <button class="data-btn" onclick="exportData()" title="T·∫£i v·ªÅ file backup d·ªØ li·ªáu">‚¨áÔ∏è Backup</button>
                <button class="data-btn" onclick="document.getElementById('importFile').click()"
                    title="N·∫°p d·ªØ li·ªáu t·ª´ file backup">‚¨ÜÔ∏è Restore</button>
                <input type="file" id="importFile" accept=".json" style="display:none" onchange="importData(event)">
            </div>
            <div class="sidebar-list" id="sidebarList">
                <!-- Account rows injected here -->
            </div>
        </aside>

        <!-- MAIN DETAIL PANEL -->
        <main class="detail-panel" id="detailPanel">
            <!-- Default: Dashboard overview -->
            <div class="detail-placeholder" id="detailPlaceholder">
                <div class="placeholder-icon">üìã</div>
                <p>Ch·ªçn m·ªôt t√†i kho·∫£n ƒë·ªÉ xem chi ti·∫øt</p>
            </div>
            <div class="detail-content hidden" id="detailContent">
                <div class="detail-header">
                    <h2 id="detailTitle">Account Name</h2>
                </div>
                <div class="detail-stats" id="detailStats">
                    <!-- Stats cards rendered here -->
                </div>
                <div class="detail-body">
                    <div class="detail-tasks" id="detailTasks">
                        <!-- Tasks rendered here -->
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Collapsible Search Panel (for inventory search) -->
    <div id="searchPanel" class="search-panel hidden">
        <div class="search-panel-header">
            <h3>üîç T√¨m v·∫≠t ph·∫©m</h3>
            <button class="search-close-btn" onclick="toggleSearch()" title="ƒê√≥ng">‚úï</button>
        </div>
        <div class="search-mode-toggle">
            <button class="search-mode-btn active" onclick="setSearchMode('dropdown')" id="searchModeDropdown">üìã Danh
                s√°ch</button>
            <button class="search-mode-btn" onclick="setSearchMode('keyword')" id="searchModeKeyword">üîç T·ª´
                kh√≥a</button>
        </div>
        <div class="search-input-area">
            <select id="searchDropdown" class="search-select" onchange="searchItems()">
                <option value="">-- Ch·ªçn v·∫≠t ph·∫©m ƒë·ªÉ t√¨m --</option>
                <option value="Th√¢n Ph√°p 1-5">Th√¢n Ph√°p 1-5</option>
                <option value="Th√¢n Ph√°p 6-10">Th√¢n Ph√°p 6-10</option>
                <option value="S·ª©c M·∫°nh 1-5">S·ª©c M·∫°nh 1-5</option>
                <option value="S·ª©c M·∫°nh 6-10">S·ª©c M·∫°nh 6-10</option>
                <option value="Sinh Kh√≠ 1-5">Sinh Kh√≠ 1-5</option>
                <option value="Sinh Kh√≠ 6-10">Sinh Kh√≠ 6-10</option>
                <option value="Th·ªÉ L·ª±c 1-50">Th·ªÉ L·ª±c 1-50</option>
                <option value="Th·ªÉ L·ª±c 51-100">Th·ªÉ L·ª±c 51-100</option>
                <option value="Sinh L·ª±c 1-50">Sinh L·ª±c 1-50</option>
                <option value="Sinh L·ª±c 51-100">Sinh L·ª±c 51-100</option>
                <option value="N·ªôi L·ª±c 1-50">N·ªôi L·ª±c 1-50</option>
                <option value="N·ªôi L·ª±c 51-100">N·ªôi L·ª±c 51-100</option>
            </select>
            <input type="text" id="searchKeyword" class="search-input hidden" placeholder="Nh·∫≠p t√™n v·∫≠t ph·∫©m..."
                oninput="searchItems()">
        </div>
        <div id="searchResults" class="search-results hidden"></div>
    </div>

    <!-- Account Modal -->
    <div id="accountModal" class="modal hidden">
        <div class="modal-content">
            <h2 id="modalTitle">Add Account</h2>
            <form id="accountForm">
                <input type="hidden" id="accId">
                <div class="form-group">
                    <label for="accName">Account Name</label>
                    <input type="text" id="accName" required placeholder="e.g. Main Acc - Server Asia">
                </div>
                <div class="form-group">
                    <label for="charName">Character Name</label>
                    <input type="text" id="charName" placeholder="e.g. DragonSlayer99">
                </div>
                <div class="form-group">
                    <label for="accNote">Note</label>
                    <input type="text" id="accNote" placeholder="e.g. Login via Google">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn cancel-btn" id="closeModal">Cancel</button>
                    <button type="submit" class="btn save-btn">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Inventory Modal -->
    <div id="inventoryModal" class="modal hidden">
        <div class="modal-content">
            <h2>üéí Kho ƒë·ªì - <span id="invAccName"></span></h2>
            <form id="inventoryForm">
                <input type="hidden" id="invAccId">
                <div class="inv-section">
                    <h3>üí∞ Ti·ªÅn t·ªá</h3>
                    <div class="ocr-paste-area" id="ocrPasteArea" tabindex="0">
                        <span id="ocrStatus">üì∏ Nh·∫•n v√†o ƒë√¢y & d√°n ·∫£nh (Ctrl+V) ƒë·ªÉ t·ª± ƒëi·ªÅn s·ªë B·∫°c</span>
                    </div>
                    <div class="inv-row">
                        <label>B·∫°c</label>
                        <div class="inv-input-unit">
                            <input type="number" id="invSilver" min="0" placeholder="0">
                            <span class="inv-unit">v·∫°n</span>
                        </div>
                    </div>
                </div>
                <div class="inv-section">
                    <h3>üì¶ T√†i s·∫£n</h3>
                    <div id="invItemsList"></div>
                    <div class="inv-add-preset">
                        <select id="presetItemSelect">
                            <option value="">-- Ch·ªçn t·ª´ danh s√°ch --</option>
                            <option value="Th√¢n Ph√°p 1-5">Th√¢n Ph√°p 1-5</option>
                            <option value="Th√¢n Ph√°p 6-10">Th√¢n Ph√°p 6-10</option>
                            <option value="S·ª©c M·∫°nh 1-5">S·ª©c M·∫°nh 1-5</option>
                            <option value="S·ª©c M·∫°nh 6-10">S·ª©c M·∫°nh 6-10</option>
                            <option value="Sinh Kh√≠ 1-5">Sinh Kh√≠ 1-5</option>
                            <option value="Sinh Kh√≠ 6-10">Sinh Kh√≠ 6-10</option>
                            <option value="Th·ªÉ L·ª±c 1-50">Th·ªÉ L·ª±c 1-50</option>
                            <option value="Th·ªÉ L·ª±c 51-100">Th·ªÉ L·ª±c 51-100</option>
                            <option value="Sinh L·ª±c 1-50">Sinh L·ª±c 1-50</option>
                            <option value="Sinh L·ª±c 51-100">Sinh L·ª±c 51-100</option>
                            <option value="N·ªôi L·ª±c 1-50">N·ªôi L·ª±c 1-50</option>
                            <option value="N·ªôi L·ª±c 51-100">N·ªôi L·ª±c 51-100</option>
                        </select>
                        <button type="button" class="btn primary-btn" onclick="addPresetItem()"
                            style="padding: 0.4rem 0.8rem;">+</button>
                    </div>
                    <div class="inv-add-item">
                        <input type="text" id="newItemName" placeholder="Ho·∫∑c nh·∫≠p t√™n t√πy ch·ªânh...">
                        <input type="number" id="newItemQty" min="0" placeholder="SL" style="width: 80px;">
                        <button type="button" class="btn primary-btn" onclick="addInventoryItem()"
                            style="padding: 0.4rem 0.8rem;">+</button>
                    </div>
                </div>
                <div class="inv-section">
                    <h3>‚öîÔ∏è Trang b·ªã / Ghi ch√∫</h3>
                    <textarea id="invNote" rows="3" placeholder="VD: Ki·∫øm +15, Gi√°p +10..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn cancel-btn" id="closeInventory">ƒê√≥ng</button>
                    <button type="submit" class="btn save-btn">L∆∞u</button>
                </div>
            </form>
        </div>
    </div>

    <script type="module" src="app.js?v=1.3"></script>
</body>

</html>